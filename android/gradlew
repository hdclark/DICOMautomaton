#!/bin/sh
# Gradle wrapper script for DICOMautomaton Android build.
# The Gradle wrapper jar (gradle/wrapper/gradle-wrapper.jar) must be present
# in the repository.  If it is missing, regenerate it with:
#   gradle wrapper --gradle-version 8.4
# and commit the result.

set -e

# Determine script location (supports symlinks).
APP_HOME="$(cd "$(dirname "$0")" && pwd)"
GRADLE_WRAPPER_JAR="${APP_HOME}/gradle/wrapper/gradle-wrapper.jar"

# The wrapper jar must be committed alongside this script.
if [ ! -f "${GRADLE_WRAPPER_JAR}" ]; then
    echo "ERROR: Gradle wrapper JAR not found at '${GRADLE_WRAPPER_JAR}'." >&2
    echo "Regenerate it with: gradle wrapper --gradle-version 8.4" >&2
    echo "Then commit the generated 'gradle/wrapper/gradle-wrapper.jar' file." >&2
    exit 1
fi

# Locate Java.
if [ -n "${JAVA_HOME}" ] && [ -x "${JAVA_HOME}/bin/java" ]; then
    JAVACMD="${JAVA_HOME}/bin/java"
elif command -v java >/dev/null 2>&1; then
    JAVACMD=java
else
    echo "ERROR: Java not found. Please set JAVA_HOME or ensure 'java' is on PATH." >&2
    exit 1
fi

# Invoke Gradle.
exec "${JAVACMD}" \
    -classpath "${GRADLE_WRAPPER_JAR}" \
    org.gradle.wrapper.GradleWrapperMain "$@"
